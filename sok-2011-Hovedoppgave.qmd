---
title: "SOK-2011-mappeinnlevering 2a"
author: "Kandidatnr 23"
toc: true
toc-title: Innhold
toc-depth: 4
number-sections: true
execute: 
  warning: false
  echo: false
highlight-style: pygments
format:
  html: 
    code-fold: true
    html-math-method: katex
  pdf:
    geometry: 
      - top=30mm
      - left=30mm
  docx: default
---

**SJEKKLISTE FOR DEL 1:**

**Gjennomgående:**\
- Språket i oppgaven er på et riktig nivå for en akademisk oppgave.\
- Resonnementene er logiske og enkle å følge.\
- Referansene er korrekte, og stilen er konsekvent.\
- Alle referanser i teksten er med i referanselisten og vice versa.\
- Kode er opplastet på GitHub og lenket til i oppgaven.

## Introduksjon

**SJEKKLISTE** - Tydelig beskrivelse av temaet til oppgaven\
- God definisjon av hva økonomisk vekst er og hvordan det måles.\
- God diskusjon av hvorfor det er interessant å se på økonomisk vekst, inklusive eksempler på hvordan økonomisk vekst korrelerer med andre mål på velferd.\
- God diskusjon av problemer knyttet til å bruke nivå på og vekst i BNP per innbygger som mål på velferd.\
\
Jeg vil i denne oppgaven gjøre rede for Solows vekstteorier og anvende den på et datasett fra Verdensbanken for å analysere om og i hvilken grad disse teoriene kan bidra til å forstå hva økonomisk vekst er og hva som skaper økonomisk vekst.\
\
Bruttonasjonalproduktet(BNP) for et land er lik summen av alle varer og tjenester som produseres i et år minus varene og tjenestene som brukes i produksjonen. For å kunne sammenlikne land med hensyn til BNP brukes ofte BNP per innbygger. Vi får da et bilde av en verden med veldig store forskjeller. Samtidig er det jo ikke slik at BNP per innbygger faktisk angir hvor mye hver innbygger mottar av BNP. Det er ikke et begrep som forteller noe om fordelingen av produksjonen, bare om størrelsen. For å måle fordeling av et lands inntekter kan vi bruke Lorenz-kurve og Gini-indeks.(Mer om dette)

Selv om BNP per innbygger ikke er et fordelingsbegrep, vil det være slik at nivået er viktig for velferden til innbyggerne i et land. Også med en veldig skjev fordeling av de totale inntektene, vil det være mulig å tenke seg at jo høyere inntekter, jo mer brukes på hver innbygger. I en slik sammenheng er derfor økonomisk vekst viktig fordi det skaper større inntekter som muliggjør økt velferd selv med en skjev inntektsfordeling i et land.

I teoridelen vil jeg ta utgangspunkt i Solow BAS vekstmodell for å vise hvilke faktorer som er bestemmende for vekstnivå og vekstrate i en land. Deretter vil jeg utvide modellen til å omfatte teknologi, kvaliteten til produksjonsfaktorene og naturressurser og gjøre tilsvarende utledninger.

Den empiriske analysen vil være regresjonsanalyse av data fra World Development Indicators fra Verdensbanken som søker å besvare hva bestemmer nivå på og vekst i materiell velferd.

Det må til slutt understrekes at det som er gjort ikke representerer det endelige produktet.

## Teori: Solow-modellen

**SJEKKLISTE**\
- Tydelig redegjørelse for antakelser/forutsetninger for Solow-modellen\
- Grafisk illustrasjon av tilpasning til steady-state i Solow-modellen (med eller uten teknologisk utvikling og naturressurser).\
- Beskrivelse av og økonomisk intuisjon til hvordan sparing/investeringer, befolkningsvekst, teknologi og uttømning av naturressurser på virker nivå på og vekst i BNP per innbygger på lang sikt.\
- Dersom teori-seksjonen inneholder matematiske utledninger, er disse enkle å følge og riktige. Små slurvefeil er akseptable. Lag nummer på likningene.\
- Prediksjonene fra modellen er tydelig gjort rede for.\
\

Vekstmodellene til Solow er av ulik kompleksitet fra en enkel modell med kun produksjonsfaktorene kapital og arbeid til den mest avanserte som også har med total faktorproduktivitet og naturressurser. Jeg vil starte med å beskrive den enkle modellen og resultatene vi kommer fram til.

### Solow BAS modellen

Produksjonen($Y$) skjer ved hjelp av to innsatsfaktor, Arbeidskraft($L$) og Kapital($K$). Produktfunksjonen kan skrives generelt som $Y(t)=F(K(t),L(t))$.

#### Antakelser i modellen:

-   Alle bedrifter produserer et homogent gode

-   Det er fullkommen konkurranse. Dette innebærer at profitten er lik 0, altså at\
    $\Pi=F(K,L) - w\cdot L-r\cdot K=0$ der $w$ er lønn og $r$ er avkastning til kapitalen.

-   Produksjonen har konstant skalautbytte. Dette innebærer at hvis innsatsfaktorene øker med 1 $\%$, vil produksjonen øke med 1$\%$.

-   Produksjonsfaktorene har positiv, men avtakende grenseproduktivitet. Dette betyr at:

    $\frac{\partial Y(t)}{\partial K(t)}= \frac{\partial F(K(t),L(t))}{\partial K(t)}> 0$ og at: $\frac{\partial^2 Y(t)}{\partial K(t)^2}= \frac{\partial^2 F(K(t),L(t))}{\partial K(t)^2}< 0$\
    \
    Det samme gjelder for L(t):

    $\frac{\partial Y(t)}{\partial L(t)}= \frac{\partial F(K(t),L(t))}{\partial L(t)}> 0$ og at: $\frac{\partial^2 Y(t)}{\partial L(t)^2}= \frac{\partial^2 F(K(t),L(t))}{\partial L(t)^2}< 0$\

-   Alle i befolkningen er i arbeid $L=P$

-   Veksten i befolkningen skjer med konstant, og eksogent gitt rate $n: L(t)=L_0\cdot e^{n \cdot t}$

-   Netto sparerate er konstant lik en andel $s$ av total produksjon $Y(t)$, dvs, $I(t)=s\cdot Y(t)$ Et annet uttrykk for det samme er endringer i kapitalen over tid: ${\frac{\partial K(t)}{\partial t}}$\

-   Det er ingen utenrikshandel, dvs, at landet er en lukket økonomi.

### Hva bestemmer nivå og vekst i materiell velferd

#### Hva bestemmer nivået på BNP per arbeider i langsiktig likevekt

Jeg omformer først produktfunksjonen i Solow BAS slik at den gir oss produksjon per arbeider:

**Generell produktfunksjon:** $Y(t)=F(K(t),L(t))$\
For å finne produksjon per arbeider deler vi på L:

$y=\frac {Y(t)}{L(t)}= \frac {F(K(t),L(t))} {L(t)}$

$y= F(\frac {K(t)}{L(t)},1)$ → $y=F(\frac {K(t)}{L(t)})= f(k(t))$

Vi ser av uttrykket at produksjon per arbeider($y$) er lik kapital($K$) per arbeider($L$). Dette forholdet ($\frac {K(t)}{L(t)}$) kaller vi kapitalintensiteten og benevner det $k$.\
 

**Spesifikk produktfunksjon:** $Y(t)= K(t)^\alpha\cdot L(t)^{1-\alpha}$ der $0<\alpha<1$

$y=\frac {Y(t)}{L(t)}= \frac {K(t)^\alpha\cdot L(t)^{1-\alpha}} {L(t)}=K(t)^\alpha\cdot L(t)^{1-\alpha-1}=(\frac {K(t)}{L(t)})^\alpha= k(t)^\alpha$ 

Vi ser altså at produksjonen per arbeider $y(t)$ er avhengig av kapitalintensiviteten $k(t)$.\

#### Forholdet mellom produksjon per arbeider og kapitalintensiteten

La oss nå se på hvordan produksjonen per arbeider($y(t)$) endres når kapitalintensiteten($k(t)$) endres. Jeg vil i den videre analysen bruke den spesifikke produktfunksjonen.

$y(t)= k(t)^\alpha$

$\frac{\partial y(t)}{\partial k(t)}= \alpha \cdot k(t)^{\alpha -1}>0$\
som er positiv fordi $\alpha > 0$.

Dette betyr at når mengden kapital vi har i forhold til arbeid øker, vil produksjonen per arbeider øke.

Produktfunksjonen er avtakende når $k(t)$ øker:

$\frac{\partial^2 y(t)}{\partial k(t)^2}=\alpha(\alpha-1)\cdot k(t)^{\alpha-2}<0$\
\
Vi har altså funnet at produksjonen per arbeider øker med økende kapitalintensivitet, men effekten den har på produksjon per innbygger bli stadig mindre. Vi ser av figuren at når k øker, vil bidraget til y være positivt, men til en avtakende rate.

Dette kan framstilles grafisk på denne måten:

![Grenseproduktiviteten til kapitalintensiviteten(k)](Grenseproduktivitet.png)

#### Vekst i produksjonen per arbeider

For å finne ut dette må vi se på hvordan $y(t)$ endrer seg når tiden går. Vi deriverer derfor $y(t)$ med hensyn på $t$ og får:

$\frac{\partial y(t)}{\partial t}= \alpha \cdot k^{\alpha-1} \cdot \frac{\partial k(t)}{\partial t}$

Vi deler dette på $y(t)$ for å få veksten i produksjonen pr arbeider:\
$\frac{\frac{\partial y(t)}{\partial t}}{y(t)}= \frac{\alpha \cdot k^{\alpha-1}}{k(t)^\alpha} \cdot \frac{\partial k(t)}{\partial t} = {\alpha \cdot k^{\alpha-1-\alpha}} \cdot \frac{\partial k(t)}{\partial t}= \alpha \cdot {\frac 1{k(t)}\cdot \frac{\partial k(t)}{\partial t}}$

Vi setter vekstraten i $y(t)= g_y=\frac{\frac{\partial y(t)}{\partial t}}{y(t)}$ og vekstraten til $k(t)=g_k={\frac 1{k(t)}\cdot \frac{\partial k(t)}{\partial t}}$

Vi får da at:

$g_y=\alpha \cdot g_k$

som betyr at vekstraten i produksjonen per arbeider er lik produksjonselastisiteten til kapital ganget med veksten i kapitalintensiteten. Når vi samtidig vet at grenseproduktiviteten til kapitalintensisiteten er positiv og avtakende, vil også effekten av vekst i kapitalen være avtakende.

#### Kapital per arbeider

Vi ønsker å finne ut hvordan kapitalintensiteten utvikler seg over tid og tar utgangspunkt i $k(t)= {\frac {K(t)}{L(t)}}$ som jeg først logaritmerer og deretter deriverer med hensyn på $t$:

$ln(k(t))= ln({\frac {K(t)}{L(t)}})$

$ln(k(t))= ln(K(t)) - ln(L(t))$

Deriverer med hensyn på t:

${\frac{\partial k(t)}{\partial t}}\cdot {\frac 1{k(t)}}={\frac 1{K(t)}\cdot \frac{\partial K(t)}{\partial t}}-{\frac 1{L(t)}\cdot \frac{\partial L(t)}{\partial t}}$

Vi ser at veksten i kapitalintensiviteten avhenger av veksten i kapitalen og veksten i arbeidskraften.

Vi har tidligere definert at

Arbeidskraften: $L(t) = L_0\cdot e^{n\cdot t}$

Vekstraten vil være: ${\frac{\partial L(t)}{\partial t}}=L_0 \cdot n$

Vi har også at\
${\frac{\partial K(t)}{\partial t}}=I(t)=s\cdot Y(t)$,

altså at kapitalens utvikling over tid er det samme som investeringene som igjen er definert som andel av total produksjon, der $s$ er spareraten.\
Vi setter inn for disse:

${\frac{\partial k(t)}{\partial t}}\cdot {\frac 1{k(t)}}={\frac {s\cdot Y(t)}{K(t)}-L_0 \cdot n}$

Ganger med $\frac 1 {L(t)}$ oppe og nede og får

${\frac{\partial k(t)}{\partial t}}\cdot {\frac 1{k(t)}}=s \cdot\frac {\frac {Y(t)}{L(t)}}{\frac {K(t)}{L(t)}}-{\frac 1{L(t)}} \cdot L_0 \cdot n$

og får at:

${\frac{\partial k(t)}{\partial t}}\cdot {\frac 1{k(t)}}=s \cdot\frac {y(t)}{k(t)}-n$

Ganger med $k(t)$ på begge sider som da gir at:

${\frac{\partial k(t)}{\partial t}}=s \cdot y(t)-n \cdot k(t)$\
\
Vi ser at utviklingen av kapitalintensiteten er avhengig av forholdet mellom faktiske nettoinvesteringer ($s \cdot y(t)$) og nødvendige investeringer for å erstatte arbeidere med kapital ($n \cdot k(t)$).

#### Langsiktig likevekt i produksjon per arbeider og kapitalintensivitet

Vi definerer langsiktig likevekt (Steady-state) som en situasjon der all automatisk tilpasning har skjedd og at vi har enten stabilt nivå på BNP per arbeider, eller stabil vekstrate i BNP per arbeider. Av gjennomgangen har vi at likevekt er oppnådd når $s\cdot y(t)=n\cdot k(t)$, altså at det er samsvar mellom de faktiske nettoinvesteringene og de nødvendige investeringene for å erstatte arbeidere med kapital.

Figuren viser bevegelsen mot en steady state likevekt.

![Solow BAS steady-state](Solow%20BAS%20steady-state.png)

La oss ta utgangspunkt i nivå $k_1$.Her vil $s \cdot y(t)>n \cdot k(t)$ som betyr at de faktiske investeringene er større enn de som er nødvendig for å erstatte arbeidskraft. Dette betyr at kapitalintensiviteten øker og da vil også produksjonen per innbygger øke. Vi får en bevegelse utover i planet til $k^{ss}$ i figuren.

Tar vi utgangspunkt i nivå $k_2$ vil $s \cdot y(t)<n \cdot k(t)$. Her er de faktiske investeringene mindre enn det som er nødvendig for å erstatte arbeidskraft. Kapitalintensiviteten vil avta og dermed også produksjonen per innbygger. I figuren får vi en bevegelse innover i planet til $k^{ss}$.

Dette betyr at vi har en langsiktig likevekt når kapitalintensiviteten er konstant.

**Matematisk løsning:**

**Nivå på kapitalintensivitet i likevekt(steady-state):**\
I steady-state har vi altså at:\
${\frac{\partial k(t)}{\partial t}}=s \cdot y(t)-n \cdot k(t) = 0$

Vi bruker at

$y(t)= k(t)^\alpha$ (linje 107) og setter dette inn i uttrykket:

$s\cdot k(t)^\alpha-n \cdot k(t) = 0$

Vi deler på $k(t)$:

${\frac{s\cdot k(t)^\alpha}{k(t)}}-n=0$

som gir:

${s\cdot k(t)^{\alpha-1}}=n$

Deler på begge sider med $k(t)^{\alpha-1}$:

${\frac {s\cdot k(t)^{\alpha-1}}{k(t)^{\alpha-1}}}={\frac{n}{k(t)^{\alpha-1}}}$\
Dette er det samme som:

$s=n\cdot k(t)^{1-\alpha}$\
Deler på $n$: ${\frac {s}{n}}={k(t)^{1-\alpha}}$ og ganger eksponenten på begge sider med ${\frac{1}{1-\alpha}}$ som da gir oss:

$k(t)^{ss} = {(\frac {s}{n})}^{\frac{1}{1-\alpha}}$\
som er kapitalintensiviteten i langsiktig likevekt(steady state)\
 

**Nivå på produksjon per arbeider i likevekt(steady-state):**

Dette finner vi ved å ta utgangspunkt i $y(t)= k(t)^\alpha$ og setter inn uttrykket vi har funnet for kapitalintensiviteten i steady state:

$y(t)^{ss}={(\frac{s}{n})}^{\frac{\alpha}{1-\alpha}}$

### Solow-modellen med teknologisk utvikling og naturressurser.

Jeg vil nå ta for meg den utvidete modellen og utlede hva som påvirker vekst i produksjonen per arbeider i og utenom steady-state.

Produktfunksjonen til denne modellen kan generelt framstilles på følgende måte:

(1) $Y(t) = A(t)\cdot F(\underline K(t),\underline L(t),\underline R(t))$ der

(2) Effektiv mengde kapital er: $\underline K(t) = q_K\cdot K(t)$

(3) Effektiv mengde arbeidskraft er: $\underline L(t) = q_L\cdot L(t)$

(4) Effektiv mengde ressurser er: $\underline R(t) = q_R\cdot R(t)$

og $q_K, q_L$ og $q_R$ er kvalitetsindeks for de tre innsatsfaktorene.

Denne produktfunksjonen kan spesifiseres med en Cobb-Douglas produktfunksjon på følgende måte:

(5) $Y(t) = A(t)\cdot(q_K\cdot K(t))^\alpha\cdot(q_L\cdot L(t))^\beta\cdot(q_R\cdot R(t))^\gamma$

$0 < \alpha+\beta+\gamma < 1$ og $\alpha+\beta+\gamma = 1$

**Følgende sammenhenger er definert:**

(6) Total faktorproduktivitet: $A(t) = A_0\cdot e^{g_A\cdot t}$, vekstrate:${g_A}$

(7) Arbeidskraften: $L(t) = L_0\cdot e^{n\cdot t}$, vekstrate: ${n}$

(8) Naturressurser: $R(t) = R_0\cdot e^{-u\cdot t}$, vekstrate: ${-u}$

(9) Kvalitetsindeks til kapital: $q_{K(t)}= e^{j\cdot t}$, vekstrate: ${j}$, $j>0$

(10) Kvalitetsindeks til arbeid: $q_{L(t)}= e^{m\cdot t}$, vekstrate: ${m}$, $m>0$

(11) Kvalitetsindeks til naturressurser: $q_{R(t)}= e^{h\cdot t}$, vekstrate: ${h}$, $0\geq h\geq0$

\
Vi setter inn uttrykkene for kvalitetsindeksene inn i den spesifikke produktfunksjonen og får: $Y(t) = A_0\cdot e^{g_A\cdot t}\cdot(e^{j\cdot t}\cdot K(t))^\alpha\cdot(e^{m\cdot t}\cdot L(t))^\beta\cdot(e^{h\cdot t}\cdot R_0\cdot e^{-u\cdot t})^\gamma$

Vi samler leddene for kvalitetsindeksene sammen med teknologivariablen:

$Y(t) = A(t)\cdot q_K^\alpha \cdot q_L^\beta\cdot q_R^\gamma \cdot K(t)^\alpha \cdot L(t)^\beta\cdot R(t)^\gamma$

Vi har tidligere funnet at langs en balansert vekstbane vil forholdet mellom total kapital og total produksjon, ${\frac {K(t)}{Y(t)}}$, være konstant.

Vi bruker dette og deler på $Y(t)^{\alpha}$:

$Y(t)^{1-\alpha} = A(t)\cdot q_K^\alpha \cdot q_L^\beta\cdot q_R^\gamma \cdot ({\frac{K(t)}{Y(t)}})^\alpha \cdot L(t)^\beta\cdot R(t)^\gamma$

For å fjerne eksponenten til $Y(t)$ opphøyes begge sider med ${\frac{1}{1-\alpha}}$ som gir:\
$Y(t) = A(t)^{\frac{1}{1-\alpha}}\cdot q_K^{\frac{\alpha}{1-\alpha}} \cdot q_L^{\frac{\beta}{1-\alpha}}\cdot q_R^{\frac{\gamma}{1-\alpha}} \cdot ({\frac{K(t)}{Y(t)}})^{\frac{\alpha}{1-\alpha}} \cdot L(t)^{\frac{\beta}{1-\alpha}}\cdot R(t)^{\frac{\gamma}{1-\alpha}}$

Vi vil ha et uttrykk for produksjon per arbeider og deler derfor på $L(t)$:\
$y(t)={\frac{Y(t)}{L(t)}} = A(t)^{\frac{1}{1-\alpha}}\cdot q_K^{\frac{\alpha}{1-\alpha}} \cdot q_L^{\frac{\beta}{1-\alpha}}\cdot q_R^{\frac{\gamma}{1-\alpha}} \cdot ({\frac{K(t)}{Y(t)}})^{\frac{\alpha}{1-\alpha}} \cdot L(t)^{\frac{\beta}{1-\alpha}-1} \cdot R(t)^{\frac{\gamma}{1-\alpha}}$

Vi vil nå finne vekstraten i produksjon per arbeider og logaritmerer først:

$ln(y(t))= {\frac{1}{1-\alpha}}\cdot ln(A(t))+{\frac{\alpha}{1-\alpha}}\cdot ln(q_K)+ {\frac{\beta}{1-\alpha}}\cdot ln(q_L) + {\frac{\gamma}{1-\alpha}}\cdot ln(q_R)+ {\frac{\alpha}{1-\alpha}}(ln(K(t))- ln(Y(t)))+ ({\frac{\beta}{1-\alpha}-1}) \cdot ln(L(t))+{\frac{\gamma}{1-\alpha}}\cdot ln(R(t))$

Vi bruker uttrykkene for vekstratene fra tidligere(vise til nr på likningene) og får da:

$g_y=({\frac{1}{1-\alpha}}\cdot g_A+{\frac{\alpha}{1-\alpha}}\cdot j+ {\frac{\beta}{1-\alpha}}\cdot m + {\frac{\gamma}{1-\alpha}}\cdot h)+ {\frac{\alpha}{1-\alpha}}(g_K- g_Y)+({\frac{\beta}{1-\alpha}-1}) \cdot n-{\frac{\gamma}{1-\alpha}}\cdot u$

Langs en balansert vekstbane må $g_K-g_Y$ være lik 0 fordi ${\frac {K(t)}{Y(t)}}$ er konstant. Denne delen av uttrykket vil derfor være lik 0. Vi benevner alle vekstratene knyttet til kvalitetsindeksene for $\theta$ og får da at vekstraten i steady state er: $g_y^{ss}= \theta +({\frac{\beta}{1-\alpha}-1}) \cdot n-{\frac{\gamma}{1-\alpha}}\cdot u$

Vi gjør en liten omregning: ${\frac{\beta}{1-\alpha}-1} = {\frac{\beta}{1-\alpha}-{\frac{1-\alpha}{1-\alpha}}}={\frac{\beta+\alpha-1}{1-\alpha}}$\
En av antakelsene i modellen er konstant skalutbytte. Dette betyr at summen av produksjonselastisitetene er lik 1, altså at: $\alpha+\beta+\gamma = 1$ som innebærer at vårt uttrykk $\beta+\alpha-1 = -\gamma$

Vi setter dette inn: $g_y^{ss}= \theta -{\frac{\gamma}{1-\alpha}} \cdot n-{\frac{\gamma}{1-\alpha}}\cdot u$ som da gir:\
\
$g_y^{ss}= \theta -{\frac{\gamma}{1-\alpha}} \cdot (n+u)$

Dette uttrykket sier at:

Hvis kvaliteten på ressursene $\theta$ øker, så øker vekstraten i produksjonen per innbygger i steady state.

Den andre delen av uttrykket ser vi reduserer vekstraten. $n$ er vekstraten i befolkningen og $u$ er forbruket av naturressurser. Disse har hver for seg og i sum en effekt. For det første vil økt befolkningsvekst for gitt ressursuttak bidra til lavere vekstrate fordi man blir flere og fordi ressurssen per arbeider blir mindre. For det andre vil økt ressursbruk for gitt befolkningsvekst bety at ressursene forbrukes fortere.Mer?

Jo viktigere naturressursene er for produksjonen, jo større vil den negative effekten være på vekstraten, både direkte og via produksjonskoeffisientene.

## Data og metode

### Data

**SJEKKLISTE**\
- Tydelig oversikt over datakilder brukt i den empiriske analysen.\
- Beskrivelse og forklaring av variabler brukt i analysen.\
- Tydelig oversikt over programvare og pakker brukt til den empiriske analysen.\
- Regresjonsmodellen er korrekt beskrevet i tekst og definert med en ligning\
\

```{r}
#| label: load-pkgs
#| code-summary: "Packages"
#| message: false

# Laster ned nødvendige pakker:

suppressPackageStartupMessages(library(WDI))
suppressPackageStartupMessages(library(plyr))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(vtable))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(countrycode))
knitr::opts_chunk$set(fig.pos = "H")
```

```{r}
#| label: BNP-cap-alle

# 1. BNP per innbyggere (alle år) og initial nivå på BNP per innbyggere. WDI-variabel =  "NY.GDP.PCAP.PP.KD". 
# Velg startår = 2000 og sluttår = 2019

df_gdp0<-WDI(
  country = "all",
  indicator = c('gdppc'="NY.GDP.PCAP.PP.KD"),  
  start = 2000,
  end = 2019,
  extra = TRUE, # det å sette "extra = TRUE" fører til at vi laster inn ekstra informasjon som vi kan benytte seinere (f.eks. variabelen "region")
  cache = NULL,
  latest = NULL,
  language = "en"
)

# velger ut relevante variabler
df_gdp <- subset(df_gdp0, select = c(country, region, income, iso2c, iso3c, year, gdppc) ) %>%  
  arrange(iso3c, year) 

# Vi ønsker å ta vekk land som ikke har en iso3c kode. Dessverre er manglende observasjoner for "iso3c" (landkode) kodet som "blanks" istedet for "missing". Denne koden korrigerer dette.

df_gdp <- replace(df_gdp, df_gdp=='', NA)

# Tar vekk observasjoner som mangler data på gdppc og iso3c. 
df_gdp <- df_gdp[complete.cases( df_gdp$gdppc, df_gdp$iso3c),] 

df_gdp = df_gdp  %>%  
 dplyr::mutate(year = as.numeric(year))

# Noen land har flere observasjoner for samme år (f.eks afghanistan år 2010). Vi ønsker å ha én observasjon per land og år. Tar vekk duplikater for land og år, beholder observasjonen med størst gdppc (denne regelen kan diskuteres)
df_gdp <- df_gdp[!duplicated(df_gdp[c("iso3c", "year", max("gdppc"))]), ]  %>%  
  arrange(iso3c, year) 

# Lager et datasett med Y0 (nivå på BNP per innbyggere i år 2000)
df_gdp2000  <- df_gdp %>%  
  arrange(iso3c, year) %>% 
  group_by(iso3c) %>% #Behold den første observasjonen for BNP per innbyggere (Y0)
  slice(1) %>%
  ungroup()
df_gdp2000 = subset(df_gdp2000, select = -c(year) )

# Gir variabelen nytt navn slik at vi kan identifisere den i datasetet. 
df_gdp2000 <- plyr:: rename(df_gdp2000,c("gdppc" = "gdppc0"))

# Setter sammen data for BNP per innbygger alle år, med BNP per innbygger år 2000.
bnp_cap <- left_join(df_gdp,df_gdp2000, by=c("country", "iso2c", "iso3c", "region", "income")) 
```

```{r}
#| label: Humankapital
 
# 2. Humankapital (gjennomsnittlig antall år i skole blant befolkningen eldre enn 15 år). WDI-variabel = BAR.SCHL.15UP 
df_educ0<-WDI(
  country = "all",
  indicator = c('educ'="BAR.SCHL.15UP"),  
  start = 2000,
  end = 2019,
  extra = TRUE,
  cache = NULL,
  latest = NULL,
  language = "en"
)

# Beholder nødvendige variabler
df_educ <- subset(df_educ0, select = c(country, region, income, iso2c, iso3c, year, educ) ) %>%  
  arrange(iso3c, year) 
df_educ <- df_educ[complete.cases(df_educ$educ),] %>%  
  arrange(iso3c, year) 

df_educ = df_educ %>%  
  arrange(iso3c, year) %>%  
  mutate(educ = as.numeric(educ, na.rm = TRUE)) %>% 
 # Beregne gjennomsnittlig år i skole for tidsperioden 2000 - 2019 for hvert land, basert på tilgjenglig data (vil være 2000.2005,2010)
  group_by(iso3c) %>% 
  mutate(avg_educ = mean(educ, na.rm = TRUE))


# Her tar jeg vekk variabelen "year". Jeg gjør dette fordi vi bare har en observasjon på utdanning per land. Vi ønsker å bruke denne verdi for alle år. 
df_educ <- subset(df_educ, select = c(country, region, income, iso2c, iso3c, avg_educ)) 

utdanning <- df_educ[!duplicated(df_educ[c("iso3c")]), ]  %>%  
  arrange(iso3c) 
```

```{r}
#| label: sparerate

# 3. Gjennomsnittlig sparing for perioden 2000-2015 (lag fordi det kan ta litt tid for sparing å bli til investering)
df_nsy0<-WDI(
  country = "all",
  indicator = c( 'nsy'="NY.ADJ.NNAT.GN.ZS"),  
  start = 2000,
  end = 2015,
  extra = TRUE,
  cache = NULL,
  latest = NULL,
  language = "en"
)

df_nsy <- subset(df_nsy0, select = c(country, region, income, iso2c, iso3c, year, nsy) ) %>%  
  arrange(iso3c, year) #Behold nødvendige variabler

df_nsy <- df_nsy[complete.cases(df_nsy$nsy),] %>%  
  arrange(iso3c, year) 


df_nsy = df_nsy %>%  
  arrange(iso3c, year) %>%  
  mutate(nsy = as.numeric(nsy, na.rm = TRUE)) %>% 
  group_by(iso3c) %>% 
  mutate(avg_nsy = mean(nsy, na.rm = TRUE))
  
df_nsy <- subset(df_nsy, select = c(country, region, income, iso2c, iso3c, avg_nsy)) 
sparerate <- df_nsy[!duplicated(df_nsy[c("iso3c")]), ]  %>%  
  arrange(iso3c) 
```

```{r}
#| label: arbeidskraften

# 4. Vekst i arbeidskraften (n)
df_lf0<-WDI(
  country = "all",
  indicator = c('lf'="JI.TLF.TOTL"),  # lf = labor force
  start = 2000,
  end = 2019,
  extra = TRUE, 
  cache = NULL,
  latest = NULL,
  language = "en"
)

df_lf <- subset(df_lf0, select = c(country, region, income, iso2c, year, lf) ) %>%  
  arrange(iso2c, year) 
df_lf <-   plyr:: rename(df_lf,c("iso2c" = "iso3c")) # variabelen som identifiserer land med kode er feil i datasetet. Dette korrigerer dette


df_lf <- replace(df_lf, df_lf=='', NA)


df_lf [df_lf == 0]<-NA
df_lf <- df_lf[complete.cases(df_lf$iso3c, df_lf$lf),] 
df_lf = df_lf  %>%  
  mutate(year = as.numeric(year)) 

df_lf <- df_lf[!duplicated(df_lf[c("iso3c", "year")]), ]  %>%  
  arrange(iso3c, year) 

# Ta fram vekstraten i arbeidskraften (n). Vi har ikke data for hvert år i alle land. 
# For å beregne gjennomsnittlig årlig vekst må vi lage en variabel som måler antallet tidsperioder mellom hver observasjon.


df_n = df_lf %>%  
  arrange(iso3c, year) %>%
  ddply("iso3c",transform,
        t=c(NA,diff(year)),
        lf_growth=c(NA,diff(log(lf)))) #Vekstrate uten hensyn til tidsintervall

df_n <- df_n[complete.cases(df_n$t, df_n$lf_growth),] # Ta vekk observasjoner som mangler data på t

#Nå kan vi ta fram årlig vekstrate
df_n = df_n %>%  
        mutate(t = as.numeric(t)) %>%   
        mutate(lf_growth = as.numeric(lf_growth))
df_n <- transform(df_n, n =lf_growth/t)

# gjennomsnittlig vekstrate i arbeidskraften for hvert land
df_n <- df_n %>% # 
          ddply("iso3c",transform,
                avg_n=mean(n, na.rm = TRUE)) #Gjennomsnittlig årlig vekstrate i arbeidskraften

df_n <- subset(df_n, select = c(iso3c, avg_n) )
arbeid_vekst <- df_n[!duplicated(df_n["iso3c"]), ]  %>%  
  arrange(iso3c)
```

```{r}
#| label: samlet-data

# 5. Lag et datasett som inneholder BNP data, utdanningsdata, sparing, og arbeidskraftsdata

df <- left_join(bnp_cap, utdanning, by=c("country", "iso2c", "iso3c", "region", "income"))
df <- left_join(df, sparerate, by=c("country", "iso2c", "iso3c", "region", "income"))
df <- left_join(df, arbeid_vekst, by="iso3c")
df <- subset(df, select = c(country, region, income, iso2c, iso3c, year, gdppc, gdppc0, avg_educ, avg_nsy, avg_n))
```

```{r}
# Mange observasjoner representerer aggregerte regioner. Vi ønsker å ta vekk disse. Det finnes helt sikkert en bedre måte å gjøre dette på. Dette er den måten jeg kom på.
df_samlet <- df  %>%  
  filter(iso2c!='1A' & iso2c !='1W' & iso2c != '4E' & iso2c != '7E' & iso2c !='8S'
                                         & iso2c !='B8' & iso2c !='EU' & iso2c !='F1' & iso2c !='OE' & iso2c !='S1' & iso2c !='S2' & iso2c !="S3" 
                                         & iso2c !='S4' & iso2c !='T2' & iso2c !='T3' & iso2c !='T4' & iso2c !='T5' & iso2c !='T6' & iso2c !='T7' 
                                         & iso2c !='V1' & iso2c !='V2' & iso2c !='V3' & iso2c !='V4' & iso2c !='XC' & iso2c !='XD' & iso2c !='XE' 
                                         & iso2c !='XF' & iso2c !='XG' & iso2c !='XH' & iso2c !='XI' & iso2c !='XJ' & iso2c !='XL' & iso2c !='XM' 
                                         & iso2c !='XN' & iso2c !='XO' & iso2c !='XP' & iso2c !='XQ' & iso2c !='XT' & iso2c !='XU' & iso2c !='Z4' 
                                         & iso2c !='Z7' & iso2c !='ZF'& iso2c !='ZG'  & iso2c !='ZH' & iso2c !='ZI'  & iso2c !='ZJ'  & iso2c !='ZQ'  
                                         & iso2c !='ZT'  & iso2c !='Z7')  %>% 
  arrange(iso3c, year) 
```

```{r}
#| label: andre_variabler
#| 
# 6. Lag et datasett for resterende variabler.

df_rest0<-WDI(
  country = "all",
  indicator = c('poptot'="SP.POP.TOTL", 'gi'="NE.GDI.FTOT.KD.ZG", 'gx'="NE.EXP.GNFS.KD.ZG", 'nry'="NY.ADJ.DRES.GN.ZS", 'p'="SP.POP.GROW" ),  
  start = 2000,
  end = 2019,
  extra = TRUE,
  cache = NULL,
  latest = NULL,
  language = "en"
)

df_rest0<- replace(df_rest0, df_rest0=='', NA)
df_rest <- df_rest0[complete.cases( df_rest0$iso3c),]  %>%  
  arrange(iso2c) 


# Ta vekk observasjoner som ikke representerer land.
df_rest <- df_rest  %>%  
  filter(iso2c!='1A' & iso2c !='1W' & iso2c != '4E' & iso2c != '7E' & iso2c !='8S'
                                  & iso2c !='B8' & iso2c !='EU' & iso2c !='F1' & iso2c !='OE' & iso2c !='S1' & iso2c !='S2' & iso2c !="S3" 
                                  & iso2c !='S4' & iso2c !='T2' & iso2c !='T3' & iso2c !='T4' & iso2c !='T5' & iso2c !='T6' & iso2c !='T7' 
                                  & iso2c !='V1' & iso2c !='V2' & iso2c !='V3' & iso2c !='V4' & iso2c !='XC' & iso2c !='XD' & iso2c !='XE' 
                                  & iso2c !='XF' & iso2c !='XG' & iso2c !='XH' & iso2c !='XI' & iso2c !='XJ' & iso2c !='XL' & iso2c !='XM' 
                                  & iso2c !='XN' & iso2c !='XO' & iso2c !='XP' & iso2c !='XQ' & iso2c !='XT' & iso2c !='XU' & iso2c !='Z4' 
                                  & iso2c !='Z7' & iso2c !='ZF'& iso2c !='ZG'  & iso2c !='ZH' & iso2c !='ZI'  & iso2c !='ZJ'  & iso2c !='ZQ'  
                                  & iso2c !='ZT'  & iso2c !='Z7')  %>% 
  arrange(iso3c, year) 

df_rest <- subset(df_rest, select = c("country", "region", "income", "iso3c", "iso2c", "year", "poptot", "p", "nry", "gi", "gx"))
df_all <- left_join(df_samlet, df_rest, by=c("country", "region", "income", "iso2c", "iso3c", "year"))

# Lag en rekkefølge til variablene slik at det er enklere å få en oversikt over datamaterialet.
col_order <- c("country",  "region", "income", "iso3c", "iso2c", "year", "gdppc", "gdppc0", "poptot", "p", "avg_n", "avg_nsy", "nry", "gi", "gx", "avg_educ")
df_all <- df_all[, col_order]
```

```{r}
#| label: vekstrate_andre_variabler

# Ta fram vekstraten og gjennomsnitt for resterende variabler
df_growth0 = df_all %>%  
  
# Sorter på år og land  
  arrange(iso3c, year) %>%  
  ddply("iso3c",transform,
        gdpgrowth=c(NA,diff(log(gdppc)))*100) %>%  
  
# Årlig vekstrate i gdppc for hvert land
  mutate(gdpgrowth = as.numeric(gdpgrowth, na.rm = TRUE)) %>% 
  
# Gjennomsnittlig årlig vekstrate i BNP per innbygger for hvert land i perioden  
  ddply("iso3c",transform,avg_gdpgrowth=mean(gdpgrowth, na.rm = TRUE), 
        
# Gjennomsnittlig årlig vekstrate i investeringer for hvert land  i perioden        
        avg_gi=mean(gi, na.rm = TRUE), 
        
# Gjennomsnittlig årlig vekstrate (negativ) i naturressurser for hvert land  i perioden        
        avg_nry=mean(nry, na.rm = TRUE),  

# Gjennomsnittlig årlig vekstrate i eksport for hvert land  i perioden  
        avg_gx=mean(gx, na.rm = TRUE),       
        
# Gjennomsnittlig årlig vekstrate i befolkningen for hvert land  i perioden        
        avg_p=mean(p, na.rm = TRUE))  
        
#View(df_growth0)
df_growth0 <-  replace(df_growth0, df_growth0=='', NA)

df_growth <- df_growth0[complete.cases( df_growth0$country, df_growth0$income, df_growth0$iso3c, df_growth0$avg_gdpgrowth, df_growth0$gdppc0, df_growth0$avg_n, df_growth0$avg_p, df_growth0$avg_nsy, df_growth0$avg_nry,df_growth0$avg_gi, df_growth0$avg_gx, df_growth0$avg_educ),] # Ta vekk land som mangler data 


df_growth <- subset(df_growth, select = c("country",  "region", "income", "iso3c", "iso2c","year", "poptot", "gdppc", "gdppc0", "avg_gdpgrowth", "avg_n", "avg_p", "avg_nsy", "avg_nry", "avg_gi", "avg_gx", "avg_educ"))

# Lager datasettet som skal brukes i analysen
df_growth2019  <- df_growth %>%  
  arrange(iso3c, year) %>% 
  group_by(iso3c) %>% 
  slice(n()) %>% # Behold den SISTE observasjonen for hvert land
  ungroup()

```

```{r}
#| label: log-BNP_per_cap
# Lager en variabel som er logaritmen av BNP per innbygger.
df_growth2019$dppc <-as.numeric(df_growth2019$gdppc)
df_growth2019$ln_gdppc<-log(df_growth2019$gdppc) 
df_growth2019$ln_gdppc0<-log(df_growth2019$gdppc0) 
```

```{r}
# ordner variablene slik at de som hører sammen står sammen 
df_growth2019 <- subset(df_growth2019, select = c("country",  "region", "income", "iso3c", "iso2c","year", "poptot", "gdppc","ln_gdppc", "gdppc0","ln_gdppc0", "avg_gdpgrowth", "avg_n", "avg_p", "avg_nsy", "avg_nry", "avg_gi", "avg_gx", "avg_educ"))
```

Jeg har brukt data fra World Development Indicators som er en stor samling av data som er satt sammen av Verdensbanken. Det er laget en en "package" for R, WDI, for å forenkle analysemulighetene av de tilgjengelige data. Jeg har benyttet meg av denne i datauttaket. En utfyllende oversikt over variablene i datasettet vil man finne i Appendikset.



### Metode

*I metodeseksjonen skal du beskrive hvordan du har håndtert og analysert datamaterialet. Beskriv hvilke pakker du har brukt for å lage grafer, og hvilken metode du har brukt for å gjennomføre den økonometriske analysen.*


På bakgrunn av de matematiske utledningene er jeg kommet fram til at
følgende likning kan være et estimat for hvilke faktorer som påvirker veksten i BNP i et land:

$g_{y,i} = {\alpha} + {\beta_1} \cdot educ_i + {\beta_2} \cdot n_i + {\beta_3} \cdot p_i + {\beta_4}\cdot nsy_i  +  {\beta_5} \cdot nry_i + {\beta_6} \cdot gi_i  + {\beta_7} \cdot gx_i + {\beta_8} \cdot lnDPPC0_i + {\epsilon_i}$

der $g_{y,i}$ er vekstraten i BNP i land nr $i$,  
$educ_i$ er gjennomsnittlig antall år i skole i land nr $i$,  
$n_i$ er gjennomsnittlig vekst i arbeidsstyrken i land nr $i$,  
$p_i$ er gjennomsnittlig vekst i befolkningen i land nr $i$,  
$nsy_i$ gjennomsnitlig nettosparing i land nr $i$,  
$nry_i$ gjennomsnittlig uttømming av naturressurser i land nr $i$,  
$gi_i$ gjennomsnittlig årlig vekst i investeringene i land nr $i$,  
$gx_i$ gjennomsnittlig vekstrate i eksport i land nr $i$,  
$lnDPPC0_i$ BNP per innbygger i år 2000 i land nr $i$,  
\
*Du vil analysere sammenhengen mellom vekstraten i BNP per innbygger og de forklarende variablene ved bruk av multippel linjær regresjonsanalyse. For å estimere modellen vil du bruke minste-kvadrat-metoden (OLS). Du trenger ikke å gå inn på detaljene i minste-kvadrat-metoden, men du må skrive at du har brukt denne metoden. I tillegg må du beskrive den ligning som du estimerer ved bruk av metoden.*

*NB: det ser ut å finnes observasjoner i datamaterialet som har en stor innvirkning på resultatet ("outliers" eller "influential observations"). Du kan lese om hvordan vi kan identifisere disse her. I avsnitt 4.2 viser jeg et eksempel på hvordan du kan ta vekk disse observasjonene fra din analyse.*

*Metodedelen avslutter mappeoppgave 1.*

**Stikkord:**

-   om variablene\
-   regresjonslikning\
-   minste kvadraters metode

**Vi skal bruke minste kvadraters metode(OLS):**\
Antakelser:\
- Den avhengige variabelen er kontinuerlig, kardinal og har en normalfordeling\
- Funksjonen er linjer i parameterne $y_i = {\alpha_1} \cdot X_{1,i}+{\alpha_1} \cdot X_{2,i}+{\alpha_2} \cdot X^{2}_{3,i}+{\epsilon_i}$\
- Utvalget er tilfeldig (variablene er i.i.d -- uavhengig og identisk fordelte)\
- De forklarende variablene er ikke (perfekt) korrelerte med hverandre - Feiltermene er homoskedastiske - Det er usannsynlig at det er ekstreme observasjoner (outliers) i utvalget\
NB:forklar antakelsene og angi kilde.\
\

## Resultat

### Deskriptiv statistikk

*Den deskriptive statistikken har til formål å gi informasjon om datamaterialet og visualisere datamengden. I denne seksjonen vil du ikke teste om det er en statistisk signifikant sammenheng mellom ulike variabler, men du kan vise fram om det ser ut å finnes en korrelasjon.*

*Avsnittet skal inneholde en tabell som viser gjennomsnittlige verdier, samt min og maks-verdier for alle de variabler som du bruker i den økonometriske analysen. Tabellen skal limes inn i manuskriptet og gis navnet «Tabell 1. Deskriptiv statistikk». Beskriv tabell 1 i teksten*



```{r ordne navn i tabellen}
options(scipen = 999)
library(psych)
library(kableExtra)
table_des<-round(describe(df_growth2019[,c('ln_gdppc',
                          'avg_gdpgrowth','ln_gdppc0','avg_n','avg_p', 'avg_nsy',
                          'avg_nry','avg_gi','avg_gx','avg_educ'
                        )], fast=TRUE),2)
table_des<- as.data.frame(table_des)
rownames(table_des)<-c("log BNP per innbygger i 2019 (ln_gdppc)","Gjennomsnittlig årlig vekstrate i BNP pc 2000-2019 (%) (avg_gdpgrowth)","log BNP per innbygger i 2000 (ln_gdppc0)", "Gjennomsnittlig årlig vekstrate i arbeidskraften (%) (avg_n)","Gjennomsnittlig årlig befolkningsvekst (%) (avg_p)","Gjennomsnittlig sparing for perioden 2000-2015 (%) (avg_nsy)","Gjennomsnittlig årlig vekstrate (negativ) i naturressurser (%) (avg_nry)", "Gjennomsnittlig årlig vekstrate i investeringer (%) (avg_gi)","Gjennomsnittlig årlig vekstrate i eksport (%) (avg_gx)","Gjennomsnittlig antall år i skole (avg_educ)")

```

#### Tabell deskriptiv statitikkk
Her er en oversikt over noen parametre for alle variablene i datasettet.

```{r}
#| label: Deskriptiv statistikk

knitr::kable(table_des[,2:6], caption = "Deskriptiv statistikk", col.names = c("N", "Gjennomsnitt","Standardavvik","Min", "Maks")) %>%
  column_spec(1,width = "5cm") %>% 
  kable_styling(bootstrap_options = c("striped")) 
```

Datasettet består av 98 observasjoner i perioden 2000-2019....

#### Grafisk oversikt over noen sammenhenger   
*Avsnitt 4.1 skal også skal inneholde grafer som visualiserer korrelasjoner mellom nivå på og vekst i BNP per innbygger på den ene siden og utvalgte variabler. Beskriv hva grafene viser. Legge inn reglinjer? Lage noe per region?*



##### Sammenhengen mellom sparing og BNP per innbygger

```{r}
#| label: fig-sparing
#| fig-cap: "Forholdet mellom sparing og BNP per innbygger"


ggplot(df_growth2019, aes(x= avg_nsy, y = ln_gdppc, color = region)) +
  geom_point()+
  theme(legend.position = "bottom" , legend.text = element_text(size = 7),               legend.title = element_text(size =8))+
  labs(x= "Gjennomsnittlig sparing for perioden 2000-2015", y = "lnBNP per innbygger",title= "Forholdet mellom sparing og BNP per innbygger")
  
```


**Kommentar**\
- kanskje lage flere reglinjer? - stor spredning i datamaterialet\
- ser ut til å være liten sammenheng,prøver å fjerne outliers\
\

##### Sammenhengen mellom gjennomsnittlig årlig vekstrate i befolkningen og BNP per innbygger

```{r}
#| label: fig-befolkning
#| fig-cap: "Forholdet mellom befolkningsvekst og BNP per innbygger"
ggplot(df_growth2019, aes(x= avg_p, y = ln_gdppc, color = region) ) +
  geom_point()+
  theme(legend.position = "bottom", legend.text = element_text(size = 7),                legend.title = element_text(size =8))+
  labs(x= "Gjennomsnittlig årlig vekstrate i befolkningen", y = "lnBNP per innbygger",title= "Forholdet mellom vekstrate i befolkningen og BNP per innbygger")
```

**Kommentar**\
- ser ut til å være negativ sammenheng mellom vekstrate i befolkningen og nivå på BNP per innbygger - kommentere regionene?\
- fjerne outliers?

\

##### Sammenhengen mellom utdanningsnivå og BNP per innbygger

```{r}
#| label: fig-utdanning
#| fig-cap: "Forholdet mellom utdanning og BNP per innbygger"
ggplot(df_growth2019, aes(x= avg_educ, y = ln_gdppc, color=region) ) +
  geom_point()+
  theme(legend.position = "bottom", legend.text = element_text(size = 7),
        legend.title = element_text(size =8))+
  labs(x= "Gjennomsnittlig utdanning i antall år", y = "lnBNP per innbygger",title= "Forholdet mellom utdanning og BNP per innbygger")
```

**Kommentar**\
- sterk sammenheng mellom nivå på BNP og utdanningsnivå - fjerne Outliers\
\

##### Sammenhengen mellom sparing og årlig vekstrate i BNP per capita

```{r}

#| label: fig-sparing_og_vekst
#| fig-cap: "Forholdet mellom sparing og vekst i BNP per innbygger"
ggplot(df_growth2019, aes(x= avg_nsy, y = avg_gdpgrowth, color=region) ) +
  geom_point()+
  theme(legend.position = "bottom", legend.text = element_text(size = 7),
        legend.title = element_text(size =8)) +
  labs(x= "Gjennomsnittlig sparing for perioden 2000-2015", y = "Vekst i BNP per innbygger",title= "Forholdet mellom sparing og vekst i BNP per innbygger")
```

**Kommentar** - stor spredning i materialet, svak sammenheng - sjekker for outliers\
\

##### Sammenhengen mellom utdanningsnivå og årlig vekstrate i BNP per innbygger

```{r}
#| label: fig-utdanning_og_vekst
#| fig-cap: "Forholdet mellom utdanning og vekst i BNP per innbygger"
ggplot(df_growth2019, aes(x= avg_educ, y = avg_gdpgrowth, color=region) ) +
  geom_point()+
  theme(legend.position = "bottom", legend.text = element_text(size = 7),
        legend.title = element_text(size =8))+
  labs(x= "Gjennomsnittlig utdanning i antall år", y = "Vekstrate i BNP per innbygger",title= "Forholdet mellom utdanning og vekst i BNP per innbygger")
```

**Kommentar**\
- stor spredning i materialet, svak sammenheng - sjekker for outliers

```{r}
suppressPackageStartupMessages(library(scales))
# Her tar jeg vekk land som mangler observasjoner. Dette gjør grafen penere.  
df_growth2019_n <- df_growth2019[complete.cases(df_growth2019$region,df_growth2019$poptot, df_growth2019$avg_p, df_growth2019$gdppc),]
```

### Økonometrisk analyse

Fra gjennomgangen av Solow-modellen med teknologi og naturressurser fant vi at vekstraten i BNP per innbygger i et land påvirkes positivt av spareraten og vekstraten i arbeidskraften. Vekstraten påvikres negativt av befolkningsvekst.

*I avsnitt 4.2 skal du presentere resultatene av din regresjonsanalyse. Lag i en tabell som viser koeffisientene til alle forklarende variabler, signifikans-nivå, og R2-verdi.*

*NB 1: Det kan være en god ide å starte med en modell der du har med de variabler som den teoretiske modellen er viktigst, for å deretter legge til variabler som også kan være viktige bestemmelsesfaktorer selv om Solow-modellen ikke tar hensyn til disse.*


Her er variablene jeg har brukt i den multiple regresjonsmodellen. Den første modellen jeg vil vurdere omfatter variablene 1-7. Jeg har utelatt variablen "gjennomsnittlig vekstrate i eksport" fordi en av antakelsene i vekstmodellen til Solow er at økonomien er lukket. Signifikansnivået er satt til 1 $\%$. 
 
1.avg_educ: gjennomsnittlig antall år i skole  
2.avg_n: gjennomsnittlig vekst i arbeidsstyrken  
3.avg_p: gjennomsnittlig vekst i befolkningen 
4.avg_nsy: gjennomsnitlig nettosparing  
5.avg_nry: gjennomsnittlig uttak av naturressurser  
6.avg_gi: gjennomsnittlig årlig vekst i investeringene  
7.ln_gdppc0: BNP per innbygger i år 2000  
8.avg_gx: gjennomsnittlig vekstrate i eksport  
\
##### Modell 1 resultater
```{r}
suppressPackageStartupMessages(library(sjPlot))
suppressPackageStartupMessages(library(sjmisc))
suppressPackageStartupMessages(library(sjlabelled))

model_full_1_growth <- lm(avg_gdpgrowth  ~ avg_educ + avg_n + avg_p + avg_nsy + avg_nry + avg_gi +  ln_gdppc0, data= df_growth2019)
tab_model(model_full_1_growth)
```
Vi ser av tabellen at variablene forklarer totalt 57.7 $\%$ ($R^2$)$av sammenhengen, men at det er store forskjeller i påvirkningskraft og signifikans. Vi kan tolke resultatene slik:  

- Et år ekstra utdanning(avg_educ) gir 0.28 monetære enheter økt vekst i BNP per innbygger. Dette er et signifikant resultat fordi p-verdien er 0.001 som innebærer at det er 99 $\%$ sikkert at estimatet er forskjellig fra 0.  

- 1 $\%$ økning i arbeidsstyrken(avg_n) øker veksten i BNP per innbygger med 3.08$\%$. P-verdien er imidlertid høy - 0.560 - så det er ikke et signifikant resultat.  

- 1 $\%$ økning i befolkningen(avg_p) reduserer veksten i BNP per innbygger med 0.85 $\%$. Resultatet er signifikant fordi p-verdien er mindre enn 0.001.  

- 1 $\%$ økning i spareraten(avg_nsy) gir 0.07 $\%$ økning i veksten i BNP per innbygger. Også her er resultatet signifikant fordi p-verdien er mindre enn 0.001.  

- 1 $\%$ økning i uttaket av naturressurser(avg_nry) reduserer veksten i BNP per innbygger med 0.07 $\%$. Resultatet er ikke signifikant fordi p-verdien er 0.007.  
- 1 $\%$ økning i nettoinvesteringene gir økning i veksten i BNP per innbygger, men estimatet er ikke signifikant fordi p-verdien er 0.137.  

- 1 $\%$ økning i nivået i BNP per innbygger i år 2000 vil redusere vekstraten i BNP per innbygger med 1.48 $\%$. Resultatet er signifikant fordi p-verdien er mindre enn 0.001. 
\
En foreløpig konklusjon er at det som påvirker vekstraten i BNP per innbygger er hvilket utgangspunkt et land har. De fleste andre variablene har enten liten påvirkningskraft, er ikke signifikant eller er begge deler.


Vekstrate:

Kommentar:


##### Steg for steg analyse
Jeg vil nå bygge opp regresjonslikningen steg for steg for å se hvordan adjusted $R^2$ utvikler seg.

Den første sammenhengen jeg vil se på er mellom vekstrate i BNP og utdanning:

```{r}
model_2_growth <- lm(avg_gdpgrowth  ~ avg_educ,  data= df_growth2019)
tab_model(model_2_growth)
```
Kommentar:  
Utdanning har lite å si for vekstraten i BNP.

```{r}
model_2 <- lm(ln_gdppc  ~ avg_educ,  data= df_growth2019)
tab_model(model_2)
```

Kommentar:  
Vi ser at det er en positiv sammenheng mellom utdanning og nivå på BNP. Sammenhengen er signifikant på 1 % nivå og variablen forklarer 73.4 % av sammenhengen.

```{r}
model_3 <- lm(ln_gdppc  ~ avg_p, data= df_growth2019)
tab_model(model_3)
```

Kommentar:  
Vi ser at befolkningsøkning påvirker BNP negativt

```{r}
model_3_growth <- lm(avg_gdpgrowth ~ avg_p, data= df_growth2019)
tab_model(model_3_growth)
```

Model med eksport - ikke i tråd med antakelsen om lukket økonomi:

```{r}
model4 <- lm(ln_gdppc  ~ avg_educ + avg_nry + avg_gx, data= df_growth2019)
tab_model(model4)
```

**Kommentar**

```{r}
model_full_1 <- lm(ln_gdppc  ~ avg_n + avg_p + avg_nsy + avg_nry + avg_gi + avg_educ + ln_gdppc0, data= df_growth2019)
tab_model(model_full_1)

```


geom_smooth(method=lm, se = FALSE, fullrange = TRUE)


NB 2: Datamaterialet inneholder noen ekstreme observasjoner (outliers). Du kan identifisere disse ved å bruke koden her nede. Koden lager et datasett der outliers har blitt tatt vekk. Du kan bruke dette datasettet til å estimere nye modeller og sammenligne dine resultater.

Modell med opprinnelige data:

```{r}
model_1 <- lm(avg_gdpgrowth  ~ avg_gi , data=  df_growth2019 ) 
summary(model_1)
```

```{r}
# Vi har ekstreme observasjoner i datamaterialet. Vi må sjekke hvordan resultatene påvirkes av at vi tar vekk disse. 
# Koden her nede følger metoden som er beskrevet her: https://www.r-bloggers.com/2021/09/how-to-remove-outliers-in-r-3/ for reference

# Basert på den grafiske analysen av sammenhengen mellom vekst i BNP per innbygger og vekst i investeringer, starter jeg med å se på ekstreme observasjoner i avg_gi
Q1gi <- quantile(df_growth2019$avg_gi, .25 )
Q3gi <- quantile(df_growth2019$avg_gi, .75)
IQRgi <- IQR(df_growth2019$avg_gi)
no_outliers1 <- subset(df_growth2019, df_growth2019$avg_gi > (Q1gi - 1.5*IQRgi) & df_growth2019$avg_gi < (Q3gi + 1.5*IQRgi))
dim(no_outliers1)

```

```{r}
# Kjører rensing av alle variablene

df <- df_growth2019[complete.cases( df_growth2019$avg_gi,
                                    df_growth2019$avg_educ ),]

Q1_gi <- quantile(df$avg_gi, .25 )
Q3_gi <- quantile(df$avg_gi, .75)
IQR_gi <- IQR(df$avg_gi)

Q1_educ <- quantile(df$avg_educ, .25 )
Q3_educ <- quantile(df$avg_educ, .75)
IQR_educ <- IQR(df$avg_educ)

no_outliers_2 <- subset(df, df$avg_gi > (Q1_gi - 1.5*IQR_gi) & df$avg_gi < (Q3_gi + 1.5*IQR_gi) & df$avg_educ > (Q1_educ - 1.5*IQR_educ) & df$avg_educ < (Q3_educ + 1.5*IQR_educ))
dim(no_outliers_2)
```

Modell der ekstremverdier er fjernet

```{r}
model_2 <- lm(avg_gdpgrowth  ~ avg_gi , data= no_outliers1) 
summary(model_2)
```

Kjører rensing av alle variablene

```{r}
df <- df_growth2019[complete.cases( df_growth2019$avg_n,df_growth2019$avg_p,
                                    df_growth2019$avg_nsy, df_growth2019$avg_nry,
                                    df_growth2019$avg_gi,df_growth2019$avg_gx,
                                    df_growth2019$avg_educ ),]
Q1_n <- quantile(df$avg_n, .25 )
Q3_n <- quantile(df$avg_n, .75)
IQR_n <- IQR(df$avg_n)

Q1_p <- quantile(df$avg_p, .25 )
Q3_p <- quantile(df$avg_p, .75)
IQR_p <- IQR(df$avg_p)

Q1_nsy <- quantile(df$avg_nsy, .25 )
Q3_nsy <- quantile(df$avg_nsy, .75)
IQR_nsy <- IQR(df$avg_nsy)

Q1_nry <- quantile(df$avg_nry, .25 )
Q3_nry <- quantile(df$avg_nry, .75)
IQR_nry <- IQR(df$avg_nry)

Q1_gi <- quantile(df$avg_gi, .25 )
Q3_gi <- quantile(df$avg_gi, .75)
IQR_gi <- IQR(df$avg_gi)

Q1_gx <- quantile(df$avg_gx, .25 )
Q3_gx <- quantile(df$avg_gx, .75)
IQR_gx <- IQR(df$avg_gx)

Q1_educ <- quantile(df$avg_educ, .25 )
Q3_educ <- quantile(df$avg_educ, .75)
IQR_educ <- IQR(df$avg_educ)

no_outliers <- subset(df, df$avg_n > (Q1_n - 1.5*IQR_n) & df$avg_n < (Q3_n + 1.5*IQR_n)& df$avg_p > (Q1_p - 1.5*IQR_p) & df$avg_p < (Q3_p + 1.5*IQR_p) & df$avg_nsy > (Q1_nsy - 1.5*IQR_nsy) & df$avg_nsy < (Q3_nsy + 1.5*IQR_nsy)& df$avg_nry > (Q1_nry - 1.5*IQR_nry) & df$avg_nry < (Q3_nry + 1.5*IQR_nry) & df$avg_gi > (Q1_gi - 1.5*IQR_gi) & df$avg_gi < (Q3_gi + 1.5*IQR_gi) & df$avg_gx > (Q1_gx - 1.5*IQR_gx) & df$avg_gx < (Q3_gx + 1.5*IQR_gx) & df$avg_educ > (Q1_educ - 1.5*IQR_educ) & df$avg_educ < (Q3_educ + 1.5*IQR_educ))
dim(no_outliers)
```

Modell med bruk av datasett uten ekstremverdier

```{r}
model_full_2 <- lm(ln_gdppc  ~ avg_n + avg_p + avg_nsy + avg_nry + avg_gi + avg_educ + ln_gdppc0, data= no_outliers)
tab_model(model_full_2)
```

```{r}
model_3 <- lm(avg_gdpgrowth  ~ avg_gi , data= no_outliers1) #NB: Du må legge inn "Dine" variabler her
summary(model_3)
```

Beskriv effekten av de ulike variablene på vekst i BNP per innbygger. Er f.eks. en høyere sparerate knyttet til en høyere eller lavere vekst i BNP per innbygger? Er effekten signifikant? Beskriv i tillegg i hvor godt dine forklaringsvariabler klarer å forklare vekstraten i BNP per innbygger.

## Diskusjon

I diskusjonen skal du tolke og diskutere dine resultater. I diskusjonen skal du besvare følgende spørsmål: Støtter resultatene prediksjonene fra Solow-modellen? Hva betyr resultatene? Hvilke konklusjoner kan vi dra fra den empiriske analysen? Finnes det noen problemer med analysen eller datamaterialet som fører til at vi kanskje ikke burde dra for sterke konklusjoner?

Til slutt skal du diskutere implikasjoner for policy (politiske inngrep). Basert på din analyse, hva ville du anbefale at politiker, som ønsker å oppnå bærekraftig vekst, skal føre for politikk?

## Referanser

I referanseavsnittet skal du oppgi de referanser du har brukt til å skrive oppgaven. Alle referanser i teksten skal være med i referanselisten og vice versa. UiT Norges arktiske universitet har valgt EndNote som sitt referanseverktøy og stilen APA som sin referansestil. Det fins en egne norsk versjon av APA. Universitetsbibliotekets (UBs) EndNote-sider finner du her. Bruk stilen APA eller en annen anerkjent referansestil (Harvard, Chicago etc.). Valgt referansestil skal anvendes konsekvent. For å kunne gjøre dette enkelt, kan du laste ned EndNote-programmet. Eksempler på referanser basert på UBs norske variant av APA finner du her. Det er også mulig å integrere referanser i for eksempel Quarto, slik jeg har gjort her nede.

Hess, Peter. N. 2016. Economic Growth and Sustainable Development. Routledge. https://www.routledge.com/Economic-Growth-and-Sustainable-Development/Hess/p/book/9781138853935.

## Appendiks

I appendiks skal du legge inn en lenke til dine R-skript på GitHub. Du kan i tillegg legge inn figurer og tabeller som du ikke ønsker å ha med i hovedteksten. Om appendiks inneholder både kode, figurer og tabeller må du lage ulike avsnitt i appendiks.

### Variabeloversikt

| Variabelnavn  | Beskrivelse                                                                                                                                                                                                                       |
|--------------------------|----------------------------------------------|
| country       | Navn på land                                                                                                                                                                                                                      |
| region        | Inndeling av verden i regioner(antall land i parentes): East-Asia & Pacific(11), Europe & Central-Asia(37), Latin-America & Caribbean(18), North-America(1), South-Asia(5), Middle-East & North-Africa(3), Sub-Saharan-Africa(23) |
| income        | Inntektsgrupper: Landene er inndelt i fire kategorier etter gjennomsnittsinntekt(antall land i parentes): Low income(9), Lower middle income(29), Upper middle income(26), High income(34)                                        |
| iso3c, iso2c  | Landforkortelser                                                                                                                                                                                                                  |
| year          | År for data                                                                                                                                                                                                                       |
| poptot        | Befolkningsstørrelse i 2019                                                                                                                                                                                                       |
| gdppc         | BNP per innbygger i 2019                                                                                                                                                                                                          |
| ln_gdppc      | naturlige logaritmen av gdppc                                                                                                                                                                                                     |
| gdppc0        | BNP per innbygger i 2000                                                                                                                                                                                                          |
| ln_gdppc0     | naturlige logaritmen av gdppc0                                                                                                                                                                                                    |
| avg_gdpgrowth | Gjennomsnittlig årlig vekstrate i BNP per innbygger for hvert land i perioden                                                                                                                                                     |
| avg_n         | Gjennomsnittlig årlig vekstrate i arbeidskraften for hvert land i perioden                                                                                                                                                        |
| avg_p         | Gjennomsnittlig årlig vekstrate i befolkningen for hvert land i perioden                                                                                                                                                          |
| avg_nsy       | Gjennomsnittlig sparing for perioden 2000-2015 (forsinkelse fordi det kan ta litt tid før sparing blir til investering).                                                                                                          |
| avg_nry       | Gjennomsnittlig årlig vekstrate (negativ) i naturressurser for hvert land i perioden                                                                                                                                              |
| avg_gi        | Gjennomsnittlig årlig vekstrate i investeringer for hvert land i perioden                                                                                                                                                         |
| avg_gx        | Gjennomsnittlig årlig vekstrate i eksport for hvert land i perioden                                                                                                                                                               |
| avg_educ      | Gjennomsnittlig antall år i skole for tidsperioden 2000 - 2019 for hvert land, basert på tilgjenglig data (vil være 2000, 2005, 2010)                                                                                             |
